<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
       &middot; Rot26
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="page">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Rot26
      </a>
    </div>
    <p class="lead"></p>
  </header>
  <nav id="sidebar-nav-links">
  
  

  

  


  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  

  

  

  

  
    
  

  

  

  
    
  

  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  


  

<h1>CTFs</h1>

  
    
  

  
    
      <a class="category-link "
          href="/category/BreizhCTF.html">BreizhCTF</a>
    
  

  
    
      <a class="category-link "
          href="/category/FIC_Escape.html">FIC Escape</a>
    
  

  
    
      <a class="category-link "
          href="/category/Hacklu.html">Hacklu</a>
    
  

  
    
      <a class="category-link "
          href="/category/LabyREnth.html">LabyREnth</a>
    
  

  
    
      <a class="category-link "
          href="/category/MetaSploitable3.html">MetaSploitable3</a>
    
  

  
    
      <a class="category-link "
          href="/category/NeverlanCTF.html">NeverlanCTF</a>
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  

  

  

  

  
    
  

  

  

  
    
  

  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  



  <h1>Members</h1>
<a href="https://twitter.com/Memoi2001">Fooker</a>
<a href="https://twitter.com/kalimer0x00">Kalimer0x00</a>
<a href="https://twitter.com/govlog">Govlog</a>
<a href="https://twitter.com/maxencedun">Sp4rKy</a>
<a href="https://twitter.com/KillianChopinet/">YanZaX</a>

<br/>
<a href="https://twitter.com/Rot26CTF">@Rot26CTF</a>

</nav>


  

  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  

  

  <!-- Optional additional links to insert for icons links -->
</nav>
  
</div>

    <main class="container">
      <div class="content">
  <p>So, fun challenge.</p>

<p>What we have here is a table with some “random” data. The goal is to understand
how are the data generated, and find the one which don’t match.</p>

<p>Ex of data :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+----------+----------+
| id | value_0  | value_1  |
+----+----------+----------+
| 1  | soldiers | exchange |
| 2  | others   | solely   |
| 3  | helps    | fotos    |
| 4  | storage  | magnetic |
| 5  | customs  | arise    |
| 6  | devon    | wanted   |
| 7  | assault  | haven    |
| 8  | rouge    | below    |
| 9  | logging  | logging  |
| 10 | winning  | cover    |
+----+----------+----------+
</code></pre></div></div>

<p>This one is easy. Just find the word where <code class="highlighter-rouge">value_0 == value_1</code>.</p>

<p>Let’s solve all of them :)</p>

<h1 id="note">Note</h1>

<p>It appears that, for all the algorithm, we need to randomly find either :</p>

<ul>
  <li>the record which match</li>
  <li>the record which <em>don’t</em> match</li>
</ul>

<p>So I wrote some code to always, for a given algorithm, check both :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">filter_func</span><span class="p">):</span>
    <span class="s">""" Filters the output of challenge entries using `filter_func`
    `filter_func` must return True or False
    Will return:
        * the id of the only record which match filters if there is only one
        or
        * the id of the only record which does *not* match filters if there is only one
        * None in all other cases
    """</span>
    <span class="n">match</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">challenge</span> <span class="k">if</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">dont_match</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">challenge</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">filter_func</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"id"</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dont_match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dont_match</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"id"</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h1 id="word-dont-match">Word (don’t) match</h1>

<p>So, the same as before, we can have either <code class="highlighter-rouge">value_0 == value_1</code> or <code class="highlighter-rouge">value_0 != value_1</code>.</p>

<p>Solved it with :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">answer_find_same</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Get the list of key/value and returns the id of the entry which has key = value
        If there is not exactly one entry, return None
    """</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"value_0 == value_1"</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="invalid-ip">(In)valid IP</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-----------------+
| id | value           |
+----+-----------------+
| 1  | 174.239.15.95   |
| 2  | 35.119.143.151  |
| 3  | 249.281.249.38  |
| 4  | 190.141.220.79  |
| 5  | 126.45.54.204   |
| 6  | 134.238.20.144  |
| 7  | 231.223.147.46  |
| 8  | 78.215.192.83   |
| 9  | 176.244.229.144 |
| 10 | 88.166.176.140  |
| 11 | 120.88.43.241   |
+----+-----------------+
</code></pre></div></div>

<p>I don’t remember I had to find the only valid IP, but still, this function can handle both cases:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">answer_check_ip</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Return the id of only invalid IP
    """</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"valid ip"</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="ow">not</span> <span class="p">[</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span> <span class="p">]</span> <span class="c"># Return True if list is empty</span>
    <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="hashes">Hashes</h1>

<p>Exemple :</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+----------+--------------------------------------------------------------------------------------------------+
| id | value_0  | value_1                                                                                          |
+----+----------+--------------------------------------------------------------------------------------------------+
| 1  | species  | 46c45bea012a4371780a89959e1c778b085e2b7602a64a1f17c34f4511b1ac53b3d75191f928a4f5ca85ccbbd1932bc8 |
| 2  | aging    | 824a27137d066ebfed14d475afc49dbd578f87daf0da184e7877a334869f2b8427aef7e97b0cbb24f364cf0f5128afe1 |
| 3  | voice    | 13c042cf28405fe3959c58797d579f26f6d3a3adca95b1c5b82c8c9470ef846ec11b8ebe7041fdf6a0c15d122c65fb7d |
| 4  | monitors | d339a6e3ec90d6a7500ba0e4497eeebe89be8d3018728f38e7542c8c9c588063b825675c14aa6adc9a1d9722c276c918 |
| 5  | literary | 238ddb9b01277df09af5fbd2f07c394b09ff6abe67478296833099c78fa0fe9e3e567d3c8413647f81efb32d37e46609 |
| 6  | permits  | 098f43f7ceb0d9a4ebd8c3e5de3ad77ceafbabab005a46e4ee7abe2bc4dc9a13187521f738671d206b7a33fa19787aea |
| 7  | dozen    | d4def1624c3a574363afb04289e47ebff0ba53182ce86e46de2d5771dc1678e1ad1f4e836243b7d2b85cd795b60fe917 |
| 8  | boats    | 9465b28f356c5af0ffd4ddb61bfed2e00adbf4b4ccb8ef1a3efcd68c70fe23548be9906eff3337e9d4a36e41656a4cfa |
| 9  | atlas    | 743e58d63c40458752631c3c7618ee664bc854c392121da6deba1d9414d4d57fff39e558130612bf6ce82e146905ee0f |
| 10 | should   | ae3eee435d34e34a62e6c132f525dddb9276faebfa8a39a029ab78f087d31f6298a9c8533d1068873cf76f037a68b9bc |
| 11 | sanyo    | ec3c5cd83b908be6f3818f265271e9d767d6a4c1f6ed350403a06d8ae7ca7b99321d85bc6fcee88445bb88d8dcdf6dd2 |
+----+----------+--------------------------------------------------------------------------------------------------+
</code></pre></div></div>

<p>I had a few different hashes (sha*, md5, etc). In order to avoid looking for
all of them, the function checks most of the available hash functions available
in hashlib.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_hash</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">z</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">z</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">check_hashes</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Try all hashlib hashes function
    | 1  | utility  | 67b732dc42aaffa9056d34cc477c863c |
    """</span>
    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'md4'</span><span class="p">,</span><span class="s">'md5'</span><span class="p">,</span><span class="s">'ripemd160'</span><span class="p">,</span><span class="s">'sha'</span><span class="p">,</span><span class="s">'sha1'</span><span class="p">,</span><span class="s">'sha224'</span><span class="p">,</span><span class="s">'sha256'</span><span class="p">,</span><span class="s">'sha384'</span><span class="p">,</span><span class="s">'sha512'</span><span class="p">,</span><span class="s">'whirlpool'</span><span class="p">]:</span>
        <span class="n">name</span><span class="p">(</span><span class="s">"valid hash {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">check_hash</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">res</span> <span class="o">=</span>  <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<h1 id="crc32">CRC32</h1>

<p>Not much to say here. Sample was like :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-------------------+------------+
| id | value_0           | value_1    |
+----+-------------------+------------+
| 1  | slovenia-flame    | 2794025826 |
| 2  | italia-musical    | 1601988563 |
| 3  | reliance-length   | 3984700778 |
| 4  | managing-largest  | 3865137473 |
| 5  | headset-entities  | 3276664454 |
| 6  | detector-restrict | 4052224228 |
| 7  | brings-insured    | 2197597317 |
| 8  | auckland-utility  | 2845994991 |
| 9  | major-fires       | 403591780  |
| 10 | wooden-links      | 643340853  |
| 11 | nursery-layout    | 511607902  |
| 12 | offering-monte    | 1192467455 |
| 13 | indexes-elements  | 1829548750 |
| 14 | packing-identify  | 1359052396 |
+----+-------------------+------------+
</code></pre></div></div>

<p>And I solved it with :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_crc32</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Check the CRC32 of value_0 vs value_1
    """</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"CRC32"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">crc32</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span> <span class="o">==</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h1 id="prime-number">Prime number</h1>

<p>Another easy one, just find the only prime/not prime number :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-------+
| id | value |
+----+-------+
| 1  | 41756 |
| 2  | 88193 |
| 3  | 6179  |
| 4  | 93040 |
| 5  | 44109 |
| 6  | 77588 |
| 7  | 95949 |
| 8  | 67240 |
| 9  | 36826 |
| 10 | 44099 |
| 11 | 10853 |
| 12 | 52671 |
| 13 | 45972 |
+----+-------+
</code></pre></div></div>

<p>Solved it with:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_prime</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Check prime numbers
    """</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"prime number"</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">is_prime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="mi">25</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="rc4">RC4</h1>

<p>In the status line (which didn’t help us most of the time), we saw part of RC4 algorithm :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Status: for(c = 0; c &lt; 256; c++) { i2 = (k[i1] + s[c] + i2) % 256; swap(&amp;s[c], &amp;s[i2]); i1 = (i1 + 1) % len; }
</code></pre></div></div>

<p>and the result was base64 encoded:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+----------------------------+--------------------------------------+
| id | value_0                    | value_1                              |
+----+----------------------------+--------------------------------------+
| 1  | rangers-lanka-centres      | QxeqoVu9N52nQUpZT2hZQmjIFSsf         |
| 2  | karma-neighbor-electric    | vsb/gxr0XZWGx/ACy2KUq7AdPb1p3Ig=     |
| 3  | contacts-reprints-seeker   | UAbn2o9+m8rcc8fPwlvY7xWJhhG1f7qe     |
| 4  | medieval-variable-equipped | JSBWtqRnJaoAaAKCz9NLatsSqWH5BtbzEEg= |
| 5  | lance-workout-friend       | ytghGg0NMwPLcx8RH/kAGaokVPY=         |
| 6  | grade-lambda-stupid        | jr68d1pHkG8vGkSDOJ2pz/4g1Q==         |
| 7  | assumes-publicly-crossing  | xpxrbpUGW3/jFY+bmGfAzMj2bcefGd8F/w== |
| 8  | hindu-cache-dealer         | oIzy1/TizirkUqZQXH7kYdLs             |
| 9  | stats-polymer-arrive       | QMoIsC0JMWueGoIrfrNsy8+UwdU=         |
| 10 | antiques-other-metro       | XH9/KaF8XePZuNG0zC8xUy2GKNs=         |
| 11 | bless-emerald-freebsd      | Rk43ZnQsQj+nBeUs+qZNsc2VOSVj         |
+----+----------------------------+--------------------------------------+
</code></pre></div></div>

<p>this is the algorithm which creates the permutation matrix in RC4. I used RC4 python implementation from <a href="https://fr.wikipedia.org/wiki/RC4">Wikipedia</a> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_rc4</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"RC4"</span><span class="p">)</span>
    <span class="n">WikipediaARC4</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">crypt</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">WikipediaARC4</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">crypt</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="hex-alphabet">Hex alphabet</h1>

<p>This one was a bit more complicated to implement. We had examples like :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-----------------+--------------------------------+
| id | value_0         | value_1                        |
+----+-----------------+--------------------------------+
| 1  | myanmarsticks   | 92869e91929e8d8c8b969c948c     |
| 2  | parcelstreet    | 8f9e8d9c9a938c8b8d9a9a8b       |
| 3  | shapescurious   | 8c979e8f9a8c9c8a8d96908a8c     |
| 4  | fortypalace     | 99908d8b868f9e939e9c9a         |
| 5  | wickedoffline   | 88969c949a9b9099999396919a     |
| 6  | parentrefined   | bcadbea9a2b8bea9aaa5a2a9a8     |
| 7  | scottishcounted | 8c9c908b8b968c979c908a918b9a9b |
| 8  | middleexceed    | 92969b9b939a9a879c9a9a9b       |
| 9  | feedsferry      | 999a9a9b8c999a8d8d86           |
| 10 | edgarcentre     | 9a9b989e8d9c9a918b8d9a         |
| 11 | therebyholdem   | 8b979a8d9a9d869790939b9a92     |
+----+-----------------+--------------------------------+
</code></pre></div></div>

<p>We can see that ‘a’ seems to be 0x9e, ‘b’ = 0x9d etc … After I got more samples, it looked like a is not always equal to 0x9e.
So I had to find the value for ‘a’, then ensure each letter match the correct value .</p>

<p>Code is (with some checks to avoid matching other hex-looking samples):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">three_words_hex_value</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="s">""" Solve array with lines like :
        | 1  | beatles derek formal   | 9d9a9e8b939a8cdf9b9a8d9a94df99908d929e93     |
    by mapping each letter to a hex value
        a = 9e, then each letter decrease the value by 1 (b = 9d, c = 9c)
    """</span>
    <span class="n">name</span><span class="p">(</span><span class="s">"Hex alphabet"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span> <span class="c"># Check if value_1 column is hex</span>
        <span class="n">foo</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c"># ensure it contains at least some hex letter, not only numeric</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">int</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">None</span> <span class="c"># return if it worked</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="s">"EAX"</span> <span class="ow">in</span> <span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">alphabet</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">challenge</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">'a'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])[</span><span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">'a'</span><span class="p">)]</span>
            <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"  `-&gt; Found value </span><span class="si">%</span><span class="s">s for 'a'"</span> <span class="o">%</span> <span class="n">a</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">challenge</span><span class="p">:</span>
        <span class="n">v0</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c">#print(line)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">v0</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">v0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">alphabet</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">continue</span>
            <span class="n">c_v1</span> <span class="o">=</span> <span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">c_v0</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">alphabet</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">v0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="c">#    print("v0 : %s ; v1 : %s" % (c_v0, c_v1))</span>
            <span class="k">if</span> <span class="n">c_v0</span> <span class="o">!=</span> <span class="n">c_v1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">line</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="bp">None</span>
</code></pre></div></div>

<h1 id="shellcode">Shellcode</h1>

<p>This one was … fun. We got samples like :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+----+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id | value_0           | value_1                                                                                                                                                                                  |
+----+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1  | EAX == 0x4F625126 | 535657558becb8742cdc5d2d8c66d5574bebffc333d2bb65712123f7f38bca81c150769a858bc133d2bea0e3e49af7f68bc233d2bfbdc825e8f7f78bf281c6795988fe8bfe8bc7c95f5e5bc3                                 |
| 2  | EAX == 0x3F4553BA | 535657558becb82d121d5c4bebffc3351fab4aad33d2bb1b1a28eaf7f38bfa81ef3087bf228bf781f6adc455938bce81e9907fe0378bc133d2b91fac5f74f7f1bb0845766881c3f8ba8997755d8bc2c95f5e5bc3                 |
| 3  | EAX == 0x582FB43C | 5357558becb9ac18e26a81e9573570a54aebffc281e91cf095ed8bd981c36f4f4ecc8bfb81ef48f10a34bafec9911681f20d9b79c8795b8bc7354cefb3cf8bf881c710f682988bd78bc2bf44ebc7dd81c7bc143822477380c95f5bc3 |
| 4  | EAX == 0x0C93D68B | 535657558becb80bf7b14e05df3af61033d2bf5fd17b8ff7f78bca81c1a1a4ebac8bc133d2be95e1b14df7f68bc2c95f5e5bc3                                                                                   |
| 5  | EAX == 0xB1B85CD4 | 558becb86e05bfa82dd1d8269b2d85ca174e8bc881e93df003528bc105aa932ec835515913848bd08bc2c9c3                                                                                                 |
| 6  | EAX == 0xC26F8EC2 | 5357558becbbc5ab7cc681eb09f7a4f881c306da97f48bfb8bc7c95f5bc3                                                                                                                             |
| 7  | EAX == 0xE1BCABC5 | 535657558becbb2c107ea781eb2d1ea0e781eb3a4621de8bcb8bc1c95f5e5bc3                                                                                                                         |
| 8  | EAX == 0x53122F83 | 5657558becb8832f125333d2bf0c4ab058f7f78bc233d2b90a3134d6f7f14febffc78bf28bc6c95f5ec3                                                                                                     |
| 9  | EAX == 0x41BA5B03 | 5356558becb8d34eeeca05a9abc2bf35bb00e4048bf081c6f24e6ad881eeb6ee04258bc633d2bb6886245af7f3b9fb31d86581c105ce279a4173e18bc233d2beffcc9c4ff7f68bf28bc6c95e5bc3                             |
| 10 | EAX == 0x700059F8 | 5357558becbf9ca17a7181f7b3ea2de781ef85f506568bc7b91ba0362c81c1e55fc9d3751933d2b9ecc7b031f7f181ea2b5319dd8bc205c14e2b048bd881eb1f875f938bd381f2cd5b52d28bda8bc3c95f5bc3                   |
| 11 | EAX == 0x886C7A77 | 535657558becbbdf7d8dd981c3bff2d2c681c3a5f94b838bf381f6a03833cf8bc633d2b94a5fc33ff7f18bfa81ef8ebae8a48bcf8bc1c95f5e5bc3                                                                   |
| 12 | EAX == 0x0E7BD093 | 56558becb8d92027f733d2be0bb314bdf7f68bc235924b5f608bd081c2983f08b48bf281eebef09ddeba8c9422cf81f2b15f34ff78038bc633d2be9285d4cef7f68bc2055d5bc4de8bf08bc6c95ec3                           |
| 13 | EAX == 0xAA0A1940 | 535657558becbf5241e62c81f7a86cf0dd81f76c1d33d18bdf81c32868b6348bf381f6fe81d1fe8bd68bc2c95f5e5bc3                                                                                         |
| 14 | EAX == 0x6455E563 | 5356558becb8c21aaa1e33d2b94c2ba8d0f7f18bca81c11dbe45f68bf149ebffc181c60d1b474881c6b8f0aa2c8bde81ebc8082dc18bc32da4dd42668bd881ebd5181cfe8bd38bc2c95e5bc3                                 |
+----+-------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</code></pre></div></div>

<p>After some digging, it appears that <code class="highlighter-rouge">value_1</code> is a shellcode, and that you have to exec it and check value of EAX at the end.</p>

<p>For this I:</p>

<ul>
  <li>parsed eax</li>
  <li>injected some instructions in shellcode (right before epilogue) to print eax value</li>
  <li>put the shellcode in some C code</li>
  <li>compile It</li>
  <li>run it and get output</li>
</ul>

<p>Code looks like :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">run_shellcode</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="s">""" Check shellcode stuff
    """</span>
    <span class="n">print_sc</span><span class="o">=</span><span class="s">"</span><span class="se">\x50\x31\xC0\x31\xD2\xB0\x04\xBB\x01\x00\x00\x00\x89\xE1\xB2\x04\xcd\x80</span><span class="s">"</span> <span class="c"># SC to print $eax on stdout</span>
    <span class="n">exec_src</span><span class="o">=</span><span class="s">"""
#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
unsigned char shellcode[] = "@SC@";
int main(int argc, char **argv) {
    int (*ret)() = (int(*)())shellcode;
    ret();
}"""</span>
    <span class="n">eax</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'0x'</span><span class="p">,</span><span class="s">''</span><span class="p">)</span>
    <span class="n">sc_orig</span><span class="o">=</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s">"values"</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">leave_index</span><span class="o">=</span><span class="p">(</span><span class="n">sc_orig</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="n">b</span><span class="s">'</span><span class="se">\xc9</span><span class="s">'</span><span class="p">))</span>
    <span class="n">sc</span><span class="o">=</span><span class="p">(</span><span class="n">sc_orig</span><span class="p">[:</span><span class="n">leave_index</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'latin'</span><span class="p">)</span> <span class="o">+</span> <span class="n">print_sc</span> <span class="o">+</span> <span class="n">sc_orig</span><span class="p">[</span><span class="n">leave_index</span><span class="p">:]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'latin'</span><span class="p">))</span>
    <span class="n">sc</span><span class="o">=</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s">"</span><span class="se">\\</span><span class="s">x{:02x}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sc</span><span class="p">)])</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'spawn.c'</span><span class="p">,</span><span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">exec_src</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'@SC@'</span><span class="p">,</span><span class="n">sc</span><span class="p">))</span>
    <span class="n">call</span><span class="p">(</span><span class="s">'gcc -m32 -z execstack -o spawn spawn.c'</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ret</span><span class="o">=</span><span class="n">check_output</span><span class="p">(</span><span class="s">'./spawn'</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">good</span> <span class="o">=</span> <span class="n">hexlify</span><span class="p">(</span><span class="n">p32</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">hexlify</span><span class="p">(</span><span class="n">ret</span><span class="p">),</span><span class="mi">16</span><span class="p">)))</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">good</span> <span class="o">==</span> <span class="n">eax</span>

<span class="k">def</span> <span class="nf">check_shellcode</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="k">if</span> <span class="s">"EAX"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">run_shellcode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">apply_filter</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="main">Main</h1>

<p>Finally, the main code to run this super-solver was :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_answer</span><span class="p">(</span><span class="n">challenge</span><span class="p">):</span>
    <span class="n">check_result_list_1_value</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">answer_check_ip</span><span class="p">,</span>
        <span class="n">check_prime</span>
    <span class="p">]</span>
    <span class="n">check_result_list_2_values</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">answer_find_same</span><span class="p">,</span>
        <span class="n">check_hashes</span><span class="p">,</span>
        <span class="n">three_words_hex_value</span><span class="p">,</span>
        <span class="n">check_crc32</span><span class="p">,</span>
        <span class="n">base64_length</span><span class="p">,</span>
        <span class="n">check_shellcode</span><span class="p">,</span>
        <span class="n">check_rc4</span><span class="p">,</span>
        <span class="n">check_entropy</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">list_to_process</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="n">check_result_list_1_value</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">:</span> <span class="n">check_result_list_2_values</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">nb_values</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">challenge</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">"values"</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">check_func</span> <span class="ow">in</span> <span class="n">list_to_process</span><span class="p">[</span><span class="n">nb_values</span><span class="p">]:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">check_func</span><span class="p">(</span><span class="n">challenge</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'Would you like to play a game? [yes|no]: '</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">answer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">'y'</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c"># Submit blank answer with 'new' session to get a new session.</span>
        <span class="n">session</span> <span class="o">=</span> <span class="s">'new'</span>
        <span class="n">answer</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># Just very basic rate limiting.</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">PLAY_URL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">answer</span><span class="p">))</span>
            <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="n">json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">json</span><span class="p">[</span><span class="s">'flag'</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">'Status: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">'status'</span><span class="p">]))</span>
                <span class="k">print</span><span class="p">(</span><span class="s">'FLAG: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">'flag'</span><span class="p">]))</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">json</span><span class="p">[</span><span class="s">'error'</span><span class="p">]:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">'Error: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">'status'</span><span class="p">]))</span>
                <span class="k">break</span>
            <span class="n">session</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'session'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">json</span><span class="p">[</span><span class="s">'score'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Answer Accepted."</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">'New Score: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">'score'</span><span class="p">]))</span>
                <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Status: </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">'status'</span><span class="p">]))</span>

            <span class="n">items</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">'challenge'</span><span class="p">]</span>

            <span class="n">answer</span> <span class="o">=</span> <span class="n">find_answer</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">answer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Found answer </span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">answer</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">answer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">'Answer ID: '</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>


</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
